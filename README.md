# タワーディフェンスゲーム 🏰

戦略的多様タワーシステムを備えた高性能タワーディフェンスゲーム

## ✨ 主要機能

- **5種類の戦略的タワータイプ** - ベーシック/ラピッド/ヘビー/スナイパー/スプラッシュ
- **高度ターゲティングシステム** - 7種類の標的選択戦略
- **1000発同時ミサイル処理** - 空間分割衝突判定（80%+最適化）
- **描画バッチング最適化** - Graphics→Sprite自動変換
- **ウェーブシステム** - 5種類敵タイプ・ボスウェーブ・段階的難易度調整
- **プレイヤー専用UI** - 直感的なタワー購入・ゲーム制御・情報表示システム
- **タワーアップグレードUI** - 選択・情報表示・アップグレード・売却システム
- **ライフシステム** - 敵のゴール到達でライフ減少・ゲームオーバー機能
- **ゲーム速度制御** - 0倍速〜3倍速のリアルタイム変更
- **パーティクルエフェクト** - 1000パーティクル対応の爆発・火花エフェクト
- **リアルタイムデバッグGUI** - プロフェッショナルな監視・テストシステム
- **経済システム** - 多通貨（ゴールド/クリスタル/研究/エネルギー）・投資・アップグレード
- **マップエディター** - グリッドベース視覚的マップ編集ツール

## 🚀 クイックスタート

### 1. 依存関係のインストール

```bash
npm install
```

### 2. 開発サーバー起動

```bash
npm run dev
```

ブラウザで `http://localhost:3000` にアクセス

### 3. ゲーム操作

#### 🎮 基本操作
- **左パネル**: タワー購入ボタンをクリック→マップクリックで配置
- **右パネル**: ゲーム制御（一時停止・速度変更・次ウェーブ開始）
- **上部HUD**: リアルタイム情報表示（資金・ライフ・ウェーブ状況・特殊通貨）
- **タワークリック**: 選択・アップグレード・売却・射程表示

#### ⌨️ キーボードショートカット
- **Space**: 一時停止/再開
- **0-3**: ゲーム速度変更（停止・1倍・2倍・3倍）
- **Enter**: 次ウェーブ開始
- **Escape**: 配置モードキャンセル・タワー選択解除

#### 🎯 ゲームルール
- **ライフシステム**: 初期ライフ20・敵がゴール到達で1減少・0でゲームオーバー
- **ウェーブ進行**: 各ウェーブ間に10秒の準備時間・自動進行または手動開始
- **資金管理**: 敵撃破で資金獲得・タワー建設/アップグレードに使用
- **タワー配置**: 戦略的位置にタワーを配置・アップグレードで性能強化

#### 🛠️ 開発者機能
- **Ctrl+D**: デバッグGUI表示/非表示
- **Ctrl+E**: 経済システム管理パネル
- **Ctrl+M**: マップエディター
- **ブラウザコンソール**: 高度なテストコマンド使用可能

## 🏗️ プロジェクト構造

```
src/
├── game/                      # ゲームコア
├── entities/                  # エンティティシステム（ECS）
├── systems/                   # ゲームシステム
├── rendering/                 # 描画最適化システム
├── utils/                     # ユーティリティ（プール・空間分割）
├── ui/                        # ユーザーインターフェース
│   ├── GameHUD.ts            # ゲーム情報ヘッドアップディスプレイ
│   ├── TowerPurchaseUI.ts    # タワー購入・配置UI
│   ├── PlayerUI.ts           # プレイヤーゲーム制御UI（速度・ウェーブ）
│   ├── TowerUpgradeUI.ts     # タワーアップグレード管理UI
│   ├── EconomyUI.ts          # 経済システム管理UI（Ctrl+E）
│   ├── MapEditorUI.ts        # マップエディターUI（Ctrl+M）
│   ├── DebugUIManager.ts     # デバッグ・監視GUI（Ctrl+D）
│   ├── player-ui.css         # プレイヤーUI専用スタイル
│   └── debug-ui.css          # デバッグUI専用スタイル
└── effects/                   # 視覚エフェクト
```

## 🎯 技術スタック

- **TypeScript** - 型安全性とコード品質
- **PixiJS** - 高パフォーマンス2Dレンダリング
- **Vite** - 高速開発・ビルドツール
- **ECS（Entity Component System）** - 効率的大量オブジェクト管理

## 🎮 プレイヤー用UIシステム

### 📊 GameHUD（ヘッドアップディスプレイ）
**画面上部の常時表示情報パネル**
- **💰 資金**: 現在の所持金とリアルタイム更新
- **❤️ ライフ**: 残りライフ数（5以下で警告表示・0でゲームオーバー）
- **🌊 ウェーブ**: 現在のウェーブ番号と敵残数
- **⏱️ カウントダウン**: 次ウェーブまでの秒数表示
- **💎 特殊通貨**: クリスタル・研究・エネルギー表示

### 🏗️ TowerPurchaseUI（タワー購入システム）
**画面左側のタワー建設パネル**
- **5種類タワーカード**: 性能・価格・特性を一目で確認
- **ワンクリック購入**: カードクリック→マップクリックで即座に配置
- **動的価格表示**: 資金不足時は自動的にボタン無効化
- **配置プレビュー**: マウス追従でタワー配置位置を事前確認
- **購入ヒント**: 操作方法の分かりやすいガイド表示

### ⚡ PlayerUI（ゲーム制御システム）
**画面右側のゲーム操作パネル**
- **速度制御**: ⏸️一時停止・1x/2x/3x速度変更ボタン（キーボード0-3対応）
- **ウェーブ制御**: ▶️次ウェーブ開始・自動カウントダウン表示
- **キーボードヒント**: ショートカットキーの視覚的ガイド
- **動的状態表示**: ゲーム進行に応じたボタン状態変化

### 🎮 ゲームオーバーシステム
**ライフ0時の包括的終了処理**
- **ゲームオーバー画面**: 美しいオーバーレイと再スタートオプション
- **詳細統計画面**: ウェーブ到達数・撃破数・命中率・タワー性能
- **タワー統計**: 各タワーのレベル・撃破数・ダメージ・効率
- **ワンクリック再開**: 即座にゲームリスタート機能

### 🎨 UI設計思想
- **デバッグ機能との完全分離**: プレイヤーが必要な機能のみアクセス可能
- **統一デザイン**: ダークテーマ・半透明パネル・モダンな配色
- **直感的操作**: ワンクリック・ドラッグ&ドロップ・キーボードショートカット
- **リアルタイム更新**: 60FPSでの滑らかな情報更新
- **視覚的フィードバック**: ボタン押下・ホバー・状態変化の明確な表現

## 🎮 ゲームシステム

### 🏗️ タワータイプ（5種類）

- **🏢 ベーシック**: バランス重視（25ダメージ・2発/秒・150射程）
- **🔥 ラピッド**: 高速連射（15ダメージ・6発/秒・120射程）
- **💣 ヘビー**: 大火力（80ダメージ・0.8発/秒・180射程）
- **🎯 スナイパー**: 超長射程（100ダメージ・1発/秒・300射程）
- **💥 スプラッシュ**: 範囲攻撃（40ダメージ・1.5発/秒・140射程）

### 👹 敵タイプ（5種類）

- **👹 ベーシック**: HP100・速度50・標準型
- **💨 スピード**: HP60・速度90・高機動力
- **🛡️ ヘビー**: HP300・速度25・ミサイル耐性20%
- **🔰 アーマー**: HP200・速度40・ミサイル耐性40%・回復能力
- **👑 ボス**: HP1000・速度30・多重耐性・強力な回復能力（5ウェーブごと出現）

### 🌊 ウェーブシステム

- **段階的難易度**: ウェーブごとに15%ずつ敵数・強さが増加
- **ボスウェーブ**: 5ウェーブごとに強力なボス敵出現
- **準備期間**: 各ウェーブ間10秒の戦略立案時間
- **報酬システム**: ウェーブクリア時の資金・経験値報酬

### 💰 経済システム

- **基本通貨**: ゴールド（タワー建設・アップグレード）
- **特殊通貨**: クリスタル・研究ポイント・エネルギー
- **投資システム**: 長期的収益向上のための投資機会
- **アップグレードシステム**: ゲーム全体の性能向上

## ⚡ パフォーマンス最適化

- **オブジェクトプール**: ガベージコレクション完全回避（最大3000発ミサイル対応）
- **空間分割衝突判定**: 80%+の計算量削減（SpatialHashシステム）
- **描画バッチング**: 50エンティティ超過で自動Graphics→Sprite変換（タワーは除外し固有ビジュアル保持）
- **リアルタイム監視**: FPS・メモリ・エンティティ数の包括的追跡
- **パフォーマンステスト**: 1-2000発ミサイル負荷テスト機能

## 🎯 デバッグGUI

**Ctrl+D**でアクセス可能な高機能デバッグシステム

- **パフォーマンス監視**: FPS・エンティティ数・メモリ使用量・改善率表示
- **プール統計**: オブジェクトプール使用率・効率表示・プログレスバー
- **ミサイルテスト**: 1発〜2000発の負荷テスト・連続発射テスト
- **ウェーブ制御**: 敵タイプテスト・ウェーブ強制開始・進行監視
- **タワーテスト**: 各タワータイプの配置テスト・統計表示
- **衝突判定ベンチマーク**: 空間分割効果の定量的測定
- **レンダリングベンチマーク**: 描画パフォーマンステスト

## 🧪 コンソールコマンド

```javascript
// ミサイルテスト
game.testMassiveMissileBarrage(1000)     // 1000発一斉発射
game.testContinuousMissileStorm(100, 30) // 毎秒100発・30秒間

// パフォーマンステスト
game.benchmarkCollisionSystem(500)       // 空間分割効果測定
game.benchmarkRendering(10)              // 描画パフォーマンステスト

// タワー操作
game.getGameSystem().createTower(x, y, 'sniper') // スナイパータワー配置

// ウェーブ制御
game.forceStartNextWave()                 // 次ウェーブ強制開始
game.testSpecificEnemyType('boss')       // ボス敵テスト生成
game.showWaveInfo()                       // 詳細ウェーブ情報表示

// 経済システム
game.showEconomyStats()                   // 経済統計表示
game.debugAddCurrency('gold', 1000)      // 通貨追加
game.testInvestment('research_lab')       // 投資テスト

// マップエディター
game.showMapEditor()                      // マップエディター表示
game.loadMapFromEditor()                  // エディターからマップ読込
game.listDefaultMaps()                    // デフォルトマップ一覧
```

## 📋 開発コマンド

```bash
npm run dev         # 開発サーバー起動（localhost:3000）
npm run build       # プロダクションビルド
npm run preview     # ビルド後のプレビュー
npm run lint        # ESLintによるコード品質チェック
npm run lint:fix    # ESLintによる自動修正
npm run type-check  # TypeScriptの型チェック
```

## 🎯 実装完了機能

### 🎮 ゲームプレイシステム
✅ **プレイヤー専用UIシステム**（デバッグ機能分離・直感的操作）  
✅ **複数タワータイプシステム**（5種類・7戦略・統計追跡）  
✅ **ウェーブシステム**（段階的難易度・5敵タイプ・ボスウェーブ）  
✅ **タワーアップグレードUIシステム**（選択・情報表示・操作）  
✅ **ライフシステム**（敵ゴール到達でライフ減少・ゲームオーバー処理）  
✅ **ゲーム速度制御**（0-3倍速リアルタイム変更・キーボード対応）  
✅ **経済システム**（多通貨・投資・アップグレード・収支管理）  
✅ **マップエディター**（グリッドベース・視覚的編集・検証機能）  

### ⚡ パフォーマンス最適化
✅ **空間分割衝突判定**（80%+計算量削減）  
✅ **描画バッチング**（Graphics→Sprite自動最適化）  
✅ **オブジェクトプーリング**（1000発同時ミサイル処理）  

### 🎨 視覚・UI システム
✅ **プレイヤーUIシステム**（HUD・購入・制御パネル）  
✅ **パーティクルエフェクトシステム**（1000パーティクル対応）  
✅ **リアルタイムデバッグGUI**（開発者向けモニタリング）  
✅ **ゲームオーバーシステム**（統計表示・再スタート機能）  

## 🚀 次の開発課題

### 🔥 高優先度（基本機能として必須）
- 🏠 **メインメニューシステム**: ゲーム開始・設定・終了画面
- 📚 **チュートリアルシステム**: 初回プレイヤー向けガイド
- 🏆 **勝利条件システム**: ステージクリア・達成感の提供
- ⚙️ **設定画面**: 音量・グラフィック・キーバインド調整
- 💾 **セーブ/ロード機能**: ゲーム進行の保存・復元

### ⚡ 中優先度（体験向上）
- 🗺️ **複数マップシステム**: ステージ選択・進行管理
- 🎵 **サウンドシステム**: BGM・効果音・環境音
- ⚖️ **ゲームバランス調整**: 難易度カーブ・数値調整

## 📄 ライセンス

MIT License

---

**🎮 高性能タワーディフェンス - 戦略と技術の融合**